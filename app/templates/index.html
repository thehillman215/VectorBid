{% extends "base.html" %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="max-w-5xl mx-auto">
        <!-- Main Form Card -->
        <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
            <h2 class="text-3xl font-bold mb-2 text-gray-800">Generate Your Monthly Bid</h2>
            <p class="text-gray-600 mb-8">Tell us your preferences and we'll generate optimized PBS commands</p>

            <form hx-post="/run" hx-target="#results" hx-indicator="#spinner" class="space-y-6">
                <!-- Two Column Layout -->
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- Left Column - Pilot Info -->
                    <div class="space-y-4">
                        <h3 class="font-semibold text-gray-700 border-b pb-2">Pilot Information</h3>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Airline</label>
                            <select name="airline" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="UAL">United Airlines</option>
                                <option value="DAL">Delta Air Lines</option>
                                <option value="AAL">American Airlines</option>
                                <option value="SWA">Southwest Airlines</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Base</label>
                            <input type="text" name="base" value="EWR" placeholder="e.g., EWR, ORD, DEN"
                                   class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Position</label>
                            <select name="seat" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="CPT">Captain</option>
                                <option value="FO" selected>First Officer</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Equipment</label>
                            <select name="equipment" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="73G">737</option>
                                <option value="320">A320</option>
                                <option value="787">787</option>
                                <option value="777">777</option>
                            </select>
                        </div>
                    </div>

                    <!-- Right Column - Preferences -->
                    <div class="space-y-4">
                        <h3 class="font-semibold text-gray-700 border-b pb-2">Bidding Preferences</h3>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Persona</label>
                            <select name="persona" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="commuter">🏠 Commuter</option>
                                <option value="family">👨‍👩‍👧‍👦 Family First</option>
                                <option value="money">💰 Money Maximizer</option>
                                <option value="seniority">📈 Seniority Builder</option>
                                <option value="custom">✏️ Custom</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">
                                Your Preferences
                                <span class="text-xs text-gray-500">(Natural language)</span>
                            </label>
                            <textarea
                                name="preferences"
                                rows="6"
                                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"
                                placeholder="Examples:&#10;• I want weekends off&#10;• Prefer SAN layovers&#10;• No red-eyes&#10;• Avoid trips longer than 3 days&#10;• Maximize credit hours"
                                hx-post="/parse-preview"
                                hx-trigger="keyup changed delay:1s"
                                hx-target="#parse-preview"
                            ></textarea>
                        </div>
                    </div>
                </div>

                <!-- Parse Preview -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Detected Preferences:</label>
                    <div id="parse-preview" class="min-h-[40px] p-3 bg-gray-50 rounded-lg">
                        <span class="text-gray-400 text-sm">Start typing to see detected preferences...</span>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="flex items-center justify-between pt-4 border-t">
                    <span id="spinner" class="htmx-indicator text-blue-600">
                        ⟲ Processing...
                    </span>
                    <button type="submit"
                            class="bg-blue-600 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                        Generate PBS Commands
                    </button>
                </div>
            </form>
        </div>

        <!-- Results Area -->
        <div id="results">
            <!-- Results will be inserted here -->
        </div>
    </div>
</div>
{% endblock %}
